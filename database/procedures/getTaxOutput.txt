CREATE DEFINER=`ineqbench_user`@`%` PROCEDURE `getTaxOutput`(IN start_age int(2), IN end_age int(2), IN sexIn VARCHAR(25))
BEGIN

SELECT
	(SELECT REPLACE( FORMAT ( ( SUM(A)+SUM(B)+SUM(C)+SUM(D)+SUM(E)+SUM(F)+SUM(G)+SUM(H) )*
        (SELECT SUM(PERCENT)/100 FROM POP_AGE_PERCENT WHERE AGE BETWEEN start_age AND end_age)*
		(SELECT (PERCENT/100) FROM POP_GENDER_PERCENT WHERE GENDER=sexIn), 0) ,',','')
		FROM TAX_BAND) AS 'totalPopulation',
	(SELECT REPLACE( FORMAT ( ( SUM(A)+SUM(B) )*
        (SELECT SUM(PERCENT)/100 FROM POP_AGE_PERCENT WHERE AGE BETWEEN start_age AND end_age)*
		(SELECT (PERCENT/100) FROM POP_GENDER_PERCENT WHERE GENDER=sexIn), 0) ,',','')
		FROM TAX_BAND) AS 'totalDeprived';
END
