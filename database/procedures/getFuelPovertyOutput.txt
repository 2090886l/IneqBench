CREATE DEFINER=`ineqbench_user`@`%` PROCEDURE `getFuelPovertyOutput`(IN start_age int(2), IN end_age int(2))
BEGIN
	SELECT
	(SELECT
		REPLACE(FORMAT(SUM(ALL_PEOPLE_IN_HOUSEHOLDS)*
        (SELECT SUM(PERCENT)/100 FROM POP_AGE_PERCENT WHERE AGE BETWEEN start_age AND end_age),0),',','')
		FROM FUEL_POVERTY WHERE HEATING_CONDITION = 'All people in households:' AND OCCUPANCY_RATING = 'Total') AS 'totalPopulation',
    (SELECT
		REPLACE(FORMAT(SUM(ALL_PEOPLE_IN_HOUSEHOLDS)*
        (SELECT SUM(PERCENT)/100 FROM POP_AGE_PERCENT WHERE AGE BETWEEN start_age AND end_age),0),',','')
		FROM FUEL_POVERTY WHERE HEATING_CONDITION = 'Does not have central heating:' AND OCCUPANCY_RATING = 'Total') AS 'totalDeprived';
END
